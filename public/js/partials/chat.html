<sidebar id="sidebar1" size="80%" position="left" is-expanded="true">
  <div class="spacing" style="margin-top:65px;">
    <div class="text-center">
      <div class="btn-group">
        <label class="btn btn-default" ng-model="radioModel" uib-btn-radio="'chat'" class="text-center" title="Canales">
          <i class="fa fa-comments" aria-hidden="true"></i>
        </label>
        <label class="btn btn-default" ng-model="radioModel" uib-btn-radio="'rifa'" class="text-center" title="Rifas" ng-click="a_rifa()">
          <i class="fa fa-archive" aria-hidden="true"></i><i ng-if="radioModel!='rifa' && alert_rifa" class="fa fa-asterisk fa-spin" aria-hidden="true" style="color:#386db8; position: absolute; top: 2px; right: 2px; z-index:10;"></i>
        </label>
        <label class="btn btn-default" ng-model="radioModel" uib-btn-radio="'encuesta'" class="text-center" title="Encuestas" ng-click="a_encuesta()">
          <i class="fa fa-pie-chart" aria-hidden="true"></i><i ng-if="radioModel!='encuesta' && alert_encuesta" class="fa fa-asterisk fa-spin" aria-hidden="true" style="color:#386db8; position: absolute; top: 2px; right: 2px; z-index:10;"></i>
        </label>
        <label class="btn btn-default" ng-model="radioModel" uib-btn-radio="'subasta'" class="text-center" title="Subastas">
          <i class="fa fa-money" aria-hidden="true"></i>
        </label>
      </div>
    </div>
    <ul ng-show="radioModel=='chat'" class="sidebar-nav" style="margin-top: 90px;">
      <li class="sidebar-title">Canales públicos</li>
      <li ng-repeat="c in channels" ng-class="{active: c.name == channel.selected.name}">
        <a href="" ng-click="changeChannel(c)" title="{{ c.description }}">
          <span class="icon category-icon" ng-class="{'uncategorized': !c.color}" ng-style="{background: c.color}"></span> {{ c.name }}
        </a>
      </li>
    </ul>
    <div ng-show="radioModel=='rifa'" style="margin-top: 10px;" class="text-center">
      <h3 ng-if="user.isLogged">Rifa</h3>
      <div ng-if="can('board-config') && show_details">  
        <button class="btn btn-success btn-xs" ng-hide="rifa.create" type="button" ng-click="createRifa()">Crear nueva Rifa</button>
        <button class="btn btn-danger btn-xs" ng-hide="!rifa.create" type="button" ng-click="deleteRifa()">Quitar Rifa</button>
        <br>
      </div>
      <!-- for users -->
      <div ng-if="!can('board-config') && rifa.active && user.isLogged">
        <div ng-if="rifa.rifa">
          <div class="text-center" style="padding: 8px;">
            <p style="margin: 0;line-height: 1.3em;"><strong>{{rifa.art.nomArt}}</strong></p>
            <div>
              <img ng-src="{{rifa.art.imgUrl}}" class="img-thumbnail" style="width: 100px;">
            </div>
            <p class="text-left" style="margin: 0;line-height: 1.3em;">Boletos: {{rifa.art.cant}}</p>
            <p class="text-left" style="margin: 0;line-height: 1.3em;">Boletos comprados: {{rifa.art.cantComprados}}</p>
            <p class="text-left" style="margin: 0;line-height: 1.3em;">Boletos por usuario: {{rifa.art.cantUser}}</p>
            <p class="text-left" style="margin: 0;line-height: 1.3em;">Precio por boleto: {{rifa.art.precioBole | currency}}</p>
          </div>
        </div>
        <div ng-show="rifa.pregunta && !rifa.art.userIdG && !rifa.art.stop" style="padding: 8px;">
          <div class="text-center">
          <button uib-popover-template="dynamicPopover.templateUrl" popover-title="Participar" type="button" class="btn btn-default btn-sm" ng-click="getPosition()">Participar</button>
          <script type="text/ng-template" id="myPopoverTemplate.html">
              <div></div>
              <div class="form-group">
                <label>N° de boletos:</label>
                <input type="number" ng-model="rifa.user.cant" class="form-control" min="1" max="{{rifa.art.cantUser}}">
                <br>
                <button class="btn btn-success btn-sm" ng-click="comprarBoletos()">Comprar</button>
              </div>
          </script>
          </div>
        </div>
        <div ng-show="rifa.art.stop" style="padding: 8px;">
          <p class="text-center"><strong>Rifa cerrada</strong></p>
        </div>
        <div ng-show="rifa.art.userIdG" style="padding: 8px;">
          <div class="text-left">
            <p style="margin: 0;line-height: 1.3em;margin-top: 5px;"><strong>Ganador: {{rifa.art.userIdGname}}</strong></p>
          </div>
        </div>
        <div ng-show="!rifa.pregunta && !rifa.art.stop" class="text-center">
          <button type="button" class="btn btn-danger btn-sm" ng-if="!rifa.art.userIdG" ng-click="dejarBoletos()">Dejar rifa</button>
        </div>
      </div>
      <!-- for admins -->
      <div ng-if="can('board-config') && rifa.active">
        <br>
        <button class="btn btn-danger btn-xs" ng-if="rifa.create && !rifa.art.stop" type="button" ng-click="stopRifa()">Detener Rifa</button>
        <button class="btn btn-success btn-xs" ng-if="rifa.create && rifa.art.stop" type="button" ng-click="startRifa()">Activar Rifa</button>
        <button class="btn btn-primary btn-xs" ng-if="rifa.create && rifa.art.stop" type="button" ng-click="ganadorRifa()">Obtener Ganador</button>
        <br>
        <br>
        <div class="text-center" style="padding: 8px;">
          <p style="margin: 0;line-height: 1.3em;"><strong>{{rifa.art.nomArt}}</strong></p>
          <div>
            <img ng-src="{{rifa.art.imgUrl}}" class="img-thumbnail" style="width: 100px;">
          </div>
          <div>
            <p class="text-left" style="margin: 0;line-height: 1.1em;">Boletos: {{rifa.art.cant}}</p>
            <p class="text-left" style="margin: 0;line-height: 1.1em;">Boletos comprados: {{rifa.art.cantComprados}}</p>
            <p class="text-left" style="margin: 0;line-height: 1.1em;">Boletos por usuario: {{rifa.art.cantUser}}</p>
            <p class="text-left" style="margin: 0;line-height: 1.1em;">Precio por boleto: {{rifa.art.precioBole | currency}}</p>
          </div>
          <div ng-show="rifa.art.userIdG">
            <div>
              <p class="text-left" style="line-height: 1.3em;margin-top: 10px;"><strong>Ganador: {{rifa.art.userIdGname}}</strong></p>
              <a style="opacity: 0;font-size: 0;" class="email" href="{{rifa.art.userIdGemail}}">{{rifa.art.userIdGemail}}</a>
              <!--<p class="text-left" style="line-height: 1.3em;">email: {{rifa.art.userIdGemail}}</p>-->
              <button title="{{rifa.art.userIdGemail}}" class="btn btn-default btn-sm" ng-click="copy_to_clip()"><i class="fa fa-clipboard" aria-hidden="true"></i> Copiar</button>
            </div>
          </div>
          <div ng-show="rifa.art.go">
            <div id="number"></div>
            <div id="name"></div>
          </div>
        </div>
      </div>
    </div>
    <!-- Encuesta -->
    <div ng-show="radioModel=='encuesta'" class="text-center" style="margin-top: 10px;">
      <h3 ng-if="user.isLogged">Encuesta</h3>
      <div ng-if="can('board-config') && show_details">  
        <button class="btn btn-success btn-xs" ng-hide="encuesta.encuesta" type="button" ng-click="createEncuesta()">Crear nueva Encuesta</button>
        <button class="btn btn-danger btn-xs" ng-hide="!encuesta.encuesta" type="button" ng-click="deleteEncuesta()">Quitar Encuesta</button>
        <br><br>
      </div>
      <button class="btn btn-danger btn-xs" ng-if="can('board-config') && encuesta.encuesta && !encuesta.poll.stop" type="button" ng-click="stopEncuesta()">Detener Encuesta</button>
      <button class="btn btn-success btn-xs" ng-if="can('board-config') && encuesta.encuesta && encuesta.poll.stop" type="button" ng-click="startEncuesta()">Activar Encuesta</button>
      <div ng-if="encuesta.active && user.isLogged">
        <div ng-if="encuesta.encuesta">
          <div class="text-center" style="padding: 8px;">
            <h4 style="margin: 0;line-height: 1.3em;"><strong>{{encuesta.poll.pregunta}}</strong></h4>   
          </div>
        </div>
        <div style="padding: 8px;">
          <div class="row">
            <div class="col-xs-6 col-xs-offset-0" ng-repeat="item in encuesta.poll.items">
              <img ng-if="item.imgUrl" ng-src="{{item.imgUrl}}" class="img-rounded" alt="URL" style="height: 50px">  
              <h6 title="{{item.nombre}}" tooltip-placement="top" uib-tooltip="{{item.nombre | limitTo:8}}">{{item.nombre | limitTo:8}}</h6>
              <div><uib-progressbar class="progress-striped active" max="encuesta.poll.cant" value="item.cant" type="info"><i>{{item.cant}} / {{encuesta.poll.cant}}</i></uib-progressbar></div>
              <button ng-show="pollbttn(item.nombre)==false && !encuesta.poll.stop && !can('board-config')" tooltip-placement="top" uib-tooltip="{{item.nombre | limitTo:8}}" class="btn btn-primary btn-xs" ng-click="votar(item.nombre)">Votar</button>
              <button ng-show="pollbttn(item.nombre)==true && !encuesta.poll.stop && !can('board-config')" tooltip-placement="top" uib-tooltip="{{item.nombre | limitTo:8}}" class="btn btn-default btn-xs" ng-click="quitarvoto(item.nombre)">Quitar Voto</button>
              <br ng-hide="can('board-config') || encuesta.poll.stop">
              <br ng-hide="can('board-config') || encuesta.poll.stop">
            </div>
          </div>
          <p ng-show="encuesta.poll.stop"><strong>Encuesta Cerrada</strong></p>
          <p class="text-left">TOTAL DE VOTOS: <strong>{{encuesta.poll.cant}}</strong></p>
          <br><br><br><br>
        </div>
      </div>
    </div> 
    <div ng-show="radioModel=='subasta'" class="text-center" style="margin-top: 10px;">
      <h3 ng-if="user.isLogged">Subasta</h3>
    </div> 
  </div>
</sidebar>

<div id="wrapper" ng-class="{'stream': channel.selected.fullscreen.video}">
  <!-- Sidebar -->
  <div id="sidebar-wrapper">
    <div class="text-center">
      <div class="btn-group" style="margin-top: 7px;">
        <label class="btn btn-default" ng-model="radioModel" uib-btn-radio="'chat'" class="text-center" title="Canales">
          <i class="fa fa-comments" aria-hidden="true"></i>
        </label>
        <label class="btn btn-default" ng-model="radioModel" uib-btn-radio="'rifa'" class="text-center" title="Rifas" ng-click="a_rifa()">
          <i class="fa fa-archive" aria-hidden="true"></i><i ng-if="radioModel!='rifa' && alert_rifa" class="fa fa-asterisk fa-spin" aria-hidden="true" style="color:#386db8; position: absolute; top: 2px; right: 2px; z-index:10;"></i>
        </label>
        <label class="btn btn-default" ng-model="radioModel" uib-btn-radio="'encuesta'" class="text-center" title="Encuestas" ng-click="a_encuesta()">
          <i class="fa fa-pie-chart" aria-hidden="true"></i><i ng-if="radioModel!='encuesta' && alert_encuesta" class="fa fa-asterisk fa-spin" aria-hidden="true" style="color:#386db8; position: absolute; top: 2px; right: 2px; z-index:10;"></i>
        </label>
        <label class="btn btn-default" ng-model="radioModel" uib-btn-radio="'subasta'" class="text-center" title="Subastas">
          <i class="fa fa-money" aria-hidden="true"></i>
        </label>
      </div>
    </div>
    <ul ng-show="radioModel=='chat'" class="sidebar-nav" style="margin-top: 30px;">
      <li class="sidebar-title">Canales públicos</li>
      <li ng-repeat="c in channels" ng-class="{active: c.name == channel.selected.name}">
        <a href="" ng-click="changeChannel(c)" title="{{ c.description }}">
          <span class="icon category-icon" ng-class="{'uncategorized': !c.color}" ng-style="{background: c.color}"></span> {{ c.name }}
        </a>
      </li>
    </ul>
    <div ng-show="radioModel=='rifa'" style="margin-top: 10px;" class="text-center">
      <h3 ng-if="user.isLogged">Rifa</h3>
      <div ng-if="can('board-config') && show_details">  
        <button class="btn btn-success btn-xs" ng-hide="rifa.create" type="button" ng-click="createRifa()">Crear nueva Rifa</button>
        <button class="btn btn-danger btn-xs" ng-hide="!rifa.create" type="button" ng-click="deleteRifa()">Quitar Rifa</button>
        <br>
      </div>
      <!-- for users -->
      <div ng-if="!can('board-config') && rifa.active && user.isLogged">
        <div ng-if="rifa.rifa">
          <div class="text-center" style="padding: 8px;">
            <p style="margin: 0;line-height: 1.3em;"><strong>{{rifa.art.nomArt}}</strong></p>
            <div>
              <img ng-src="{{rifa.art.imgUrl}}" class="img-thumbnail" style="width: 100px;">
            </div>
            <p class="text-left" style="margin: 0;line-height: 1.3em;">Boletos: {{rifa.art.cant}}</p>
            <p class="text-left" style="margin: 0;line-height: 1.3em;">Boletos comprados: {{rifa.art.cantComprados}}</p>
            <p class="text-left" style="margin: 0;line-height: 1.3em;">Boletos por usuario: {{rifa.art.cantUser}}</p>
            <p class="text-left" style="margin: 0;line-height: 1.3em;">Precio por boleto: {{rifa.art.precioBole | currency}}</p>
          </div>
        </div>
        <div ng-show="rifa.pregunta && !rifa.art.userIdG && !rifa.art.stop" style="padding: 8px;">
          <div class="text-center">
          <button uib-popover-template="dynamicPopover.templateUrl" popover-title="Participar" type="button" class="btn btn-default btn-sm" ng-click="getPosition()">Participar</button>
          <script type="text/ng-template" id="myPopoverTemplate.html">
              <div></div>
              <div class="form-group">
                <label>N° de boletos:</label>
                <input type="number" ng-model="rifa.user.cant" class="form-control" min="1" max="{{rifa.art.cantUser}}">
                <br>
                <button class="btn btn-success btn-sm" ng-click="comprarBoletos()">Comprar</button>
              </div>
          </script>
          </div>
        </div>
        <div ng-show="rifa.art.stop" style="padding: 8px;">
          <p class="text-center"><strong>Rifa cerrada</strong></p>
        </div>
        <div ng-show="rifa.art.userIdG" style="padding: 8px;">
          <div class="text-left">
            <p style="margin: 0;line-height: 1.3em;margin-top: 5px;"><strong>Ganador: {{rifa.art.userIdGname}}</strong></p>
          </div>
        </div>
        <div ng-show="!rifa.pregunta && !rifa.art.stop" class="text-center">
          <button type="button" class="btn btn-danger btn-sm" ng-if="!rifa.art.userIdG" ng-click="dejarBoletos()">Dejar rifa</button>
        </div>
      </div>
      <!-- for admins -->
      <div ng-if="can('board-config') && rifa.active">
        <br>
        <button class="btn btn-danger btn-xs" ng-if="rifa.create && !rifa.art.stop" type="button" ng-click="stopRifa()">Detener Rifa</button>
        <button class="btn btn-success btn-xs" ng-if="rifa.create && rifa.art.stop" type="button" ng-click="startRifa()">Activar Rifa</button>
        <button class="btn btn-primary btn-xs" ng-if="rifa.create && rifa.art.stop" type="button" ng-click="ganadorRifa()">Obtener Ganador</button>
        <br>
        <br>
        <div class="text-center" style="padding: 8px;">
          <p style="margin: 0;line-height: 1.3em;"><strong>{{rifa.art.nomArt}}</strong></p>
          <div>
            <img ng-src="{{rifa.art.imgUrl}}" class="img-thumbnail" style="width: 100px;">
          </div>
          <div>
            <p class="text-left" style="margin: 0;line-height: 1.1em;">Boletos: {{rifa.art.cant}}</p>
            <p class="text-left" style="margin: 0;line-height: 1.1em;">Boletos comprados: {{rifa.art.cantComprados}}</p>
            <p class="text-left" style="margin: 0;line-height: 1.1em;">Boletos por usuario: {{rifa.art.cantUser}}</p>
            <p class="text-left" style="margin: 0;line-height: 1.1em;">Precio por boleto: {{rifa.art.precioBole | currency}}</p>
          </div>
          <div ng-show="rifa.art.userIdG">
            <div>
              <p class="text-left" style="line-height: 1.3em;margin-top: 10px;"><strong>Ganador: {{rifa.art.userIdGname}}</strong></p>
              <a style="opacity: 0;font-size: 0;" class="email" href="{{rifa.art.userIdGemail}}">{{rifa.art.userIdGemail}}</a>
              <!--<p class="text-left" style="line-height: 1.3em;">email: {{rifa.art.userIdGemail}}</p>-->
              <button title="{{rifa.art.userIdGemail}}" class="btn btn-default btn-sm" ng-click="copy_to_clip()"><i class="fa fa-clipboard" aria-hidden="true"></i> Copiar</button>
            </div>
          </div>
          <div ng-show="rifa.art.go">
            <div id="number"></div>
            <div id="name"></div>
          </div>
        </div>
      </div>
    </div>
    <!-- Encuesta -->
    <div ng-show="radioModel=='encuesta'" class="text-center" style="margin-top: 10px;">
      <h3 ng-if="user.isLogged">Encuesta</h3>
      <div ng-if="can('board-config') && show_details">  
        <button class="btn btn-success btn-xs" ng-hide="encuesta.encuesta" type="button" ng-click="createEncuesta()">Crear nueva Encuesta</button>
        <button class="btn btn-danger btn-xs" ng-hide="!encuesta.encuesta" type="button" ng-click="deleteEncuesta()">Quitar Encuesta</button>
        <br><br>
      </div>
      <button class="btn btn-danger btn-xs" ng-if="can('board-config') && encuesta.encuesta && !encuesta.poll.stop" type="button" ng-click="stopEncuesta()">Detener Encuesta</button>
      <button class="btn btn-success btn-xs" ng-if="can('board-config') && encuesta.encuesta && encuesta.poll.stop" type="button" ng-click="startEncuesta()">Activar Encuesta</button>
      <div ng-if="encuesta.active && user.isLogged">
        <div ng-if="encuesta.encuesta">
          <div class="text-center" style="padding: 8px;">
            <h4 style="margin: 0;line-height: 1.3em;"><strong>{{encuesta.poll.pregunta}}</strong></h4>   
          </div>
        </div>
        <div style="padding: 8px;">
          <div class="row">
            <div class="col-xs-6 col-xs-offset-0" ng-repeat="item in encuesta.poll.items">
              <img ng-if="item.imgUrl" ng-src="{{item.imgUrl}}" class="img-rounded" alt="URL" style="height: 50px">  
              <h6 title="{{item.nombre}}" tooltip-placement="top" uib-tooltip="{{item.nombre | limitTo:8}}">{{item.nombre | limitTo:8}}</h6>
              <div><uib-progressbar class="progress-striped active" max="encuesta.poll.cant" value="item.cant" type="info"><i>{{item.cant}} / {{encuesta.poll.cant}}</i></uib-progressbar></div>
              <button ng-show="pollbttn(item.nombre)==false && !encuesta.poll.stop && !can('board-config')" tooltip-placement="top" uib-tooltip="{{item.nombre | limitTo:8}}" class="btn btn-primary btn-xs" ng-click="votar(item.nombre)">Votar</button>
              <button ng-show="pollbttn(item.nombre)==true && !encuesta.poll.stop && !can('board-config')" tooltip-placement="top" uib-tooltip="{{item.nombre | limitTo:8}}" class="btn btn-default btn-xs" ng-click="quitarvoto(item.nombre)">Quitar Voto</button>
              <br ng-hide="can('board-config') || encuesta.poll.stop">
              <br ng-hide="can('board-config') || encuesta.poll.stop">
            </div>
          </div>
          <p ng-show="encuesta.poll.stop"><strong>Encuesta Cerrada</strong></p>
          <p class="text-left">TOTAL DE VOTOS: <strong>{{encuesta.poll.cant}}</strong></p>
          <br><br><br><br>
        </div>
      </div>
    </div> 
    <div ng-show="radioModel=='subasta'" class="text-center" style="margin-top: 10px;">
      <h3 ng-if="user.isLogged">Subasta</h3>
    </div>
  </div>
  <!-- /#sidebar-wrapper -->


  <!-- Page Content -->
  <div id="page-content-wrapper">
    <div class="container-fluid">
      <div class="row">
        <div class="col-lg-12">
          <div class="index-toolbar">
            <div class="index-toolbar-action">
              <div class="row">
                <div class="col-md-6 col-xs-7">
                  <h3 style="margin-top: 0">{{ channel.selected.name || "#" }}</h3>
                </div>
                <div class="col-md-6 col-xs-5 text-right">
                  <a ng-if="can('board-config')" title="Configurar este canal" class="btn btn-default btn-icon btn-round" ng-click="toggle_details()" ng-class="{'active': show_details}">
                    <i class="fa fa-fw fa-info-circle icon"></i>
                    <span class="label hidden-xs">Configurar este canal</span>
                  </a>
                  <button class="btn btn-primary men-lat" sidebar-toggle="sidebar1"><i class="fa fa-chevron-right" aria-hidden="true"></i></button>
                </div>
              </div>
            </div>
          </div>
          <!-- index-toolbar -->
          
          <div adjust-height-chat>
            <div class="message-history">
              <div class="message" ng-repeat="m in old_messages" ng-class="::{'compact':old_messages[$index-1].author.username == old_messages[$index].author.username}">
                <a href="/u/{{ m.author.username }}/{{ m.author.id }}" class="author" target="_blank" ng-if=":: old_messages[$index-1].author.username != m.author.username">
                  <span class="avatar" title="{{ m.author.username }}" ng-if="!m.author.image">{{ m.author.username[0] }}</span>
                  <img class="avatar" ng-src="{{ m.author.image }}" alt="{{ m.author.username }}" ng-if="m.author.image">
                </a>
                <div class="meta" ng-if=":: old_messages[$index-1].author.username != m.author.username">
                  <a href="/u/{{ m.author.username }}/{{ m.author.id }}" class="username" target="_blank">{{ m.author.username }}</a>
                  <span class="timestamp" uib-tooltip="{{ m.created_at | date_at }}" tooltip-popup-delay="500" tooltip-placement="right">{{ m.created_at | date:'H:mm' }}</span>
                  <span class="star"></span>
                </div>
                <span class="timestamp" ng-if=":: old_messages[$index-1].author.username == m.author.username" uib-tooltip="{{ m.created_at | date_at }}" tooltip-popup-delay="500" tooltip-placement="right">{{ m.created_at | date:'H:mm' }}</span>
                <div class="content">{{ m.content }}</div>
              </div>
              <div class="message" ng-repeat="m in messages" ng-class="::{'compact':messages[$index-1].author.username == messages[$index].author.username, 'message-highlight': m.highlight}">
                <a href="/u/{{ m.author.username }}/{{ m.author.id }}" class="author" target="_blank" ng-if=":: messages[$index-1].author.username != m.author.username">
                  <span class="avatar" title="{{ m.author.username }}" ng-if="!m.author.image">{{ m.author.username[0] }}</span>
                  <img class="avatar" ng-src="{{ m.author.image }}" alt="{{ m.author.username }}" ng-if="m.author.image">
                </a>
                <div class="meta" ng-if=":: messages[$index-1].author.username != m.author.username">
                  <a href="/u/{{ m.author.username }}/{{ m.author.id }}" class="username" target="_blank">{{ m.author.username }}</a>
                  <span class="timestamp" uib-tooltip="{{ m.created_at | date_at }}" tooltip-popup-delay="500" tooltip-placement="right">{{ m.created_at | date:'H:mm' }}</span>
                  <span class="star"></span>
                </div>
                <span class="timestamp" ng-if=":: messages[$index-1].author.username == messages[$index].author.username" uib-tooltip="{{ m.created_at | date_at }}" tooltip-popup-delay="500" tooltip-placement="right">{{ m.created_at | date:'H:mm' }}</span>
                <div show-images content="{{ m.content }}" username="{{ user.info.username }}" class="content"></div>

                <div class="message-actions" ng-if="can('board-config')">
                  <a href="" ng-click="removeMessage(m)" class="btn btn-default btn-xs">Eliminar mensaje</a>
                </div>
              </div>

              <div class="new_chat_alert" ng-if="scroll_help.scrolledUp && old_messages.length > 0"><a href="" ng-click="goToBottom()"><i class="fa fa-arrow-down"></i> Nuevos mensajes ({{ old_messages.length }})</a></div>

              <div class="spam_alert" ng-if="helpers.spam_count > 1 && !helpers.blocked">Debes dejar de hacer spam o tu cuenta se bloqueará.</div>
            </div>

            <div class="footer">
              <div class="input-box" ng-if="user.isLogged">
                <div class="input-group" style="width: 100%;">
                  <textarea class="input-box_text" placeholder="Escribe..." ng-trim="false" msd-elastic smart-area="config" ng-model="message.content"  sg-enter="addMessage()" sg-send="message.send_on_enter" ng-readonly="helpers.spam_count > 2" rows="1"></textarea>
                </div>
                <div class="row">
                  <div class="col-md-8">
                    <div class="checkbox" ng-if="can('delete-category-comments')">
                      <label>
                        <input type="checkbox" ng-model="message.highlight"> Resaltar mensajes (para moderación)
                      </label>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <p class="text-right" style="margin-top: 10px;">Te quedan {{ 200 - message.content.length }} caracteres</p>
                    <span class="input-group-btn" ng-if="!message.send_on_enter" style="text-align: right;">
                      <button class="btn btn-primary btn-send" type="button" ng-click="addMessage()"><span class="label">Enviar</span></button>
                    </span>
                  </div>
                </div>
              </div>
              <div class="blocked-input-box" ng-if="user.isLogged && (!helpers.validated || helpers.blocked)">
                <p ng-if="!helpers.validated && !helpers.blocked">Necesitas validar tu cuenta mediante correo para poder escribir en el chat.</p>
                <p class="warning" ng-if="helpers.blocked">Tu cuenta ha sido bloqueada por 60 segundos.</p>
              </div>
              <div class="input-box" ng-if="!user.isLogged">
                <p class="alert alert-warning">Necesitas crear una cuenta para participar. <a href="" ng-click="signUp()">Regístrate</a> o <a href="" ng-click="signIn()">inicia sesión</a> si ya tienes una.</p>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
  <!-- /#page-content-wrapper -->

  <!-- Sidebar -->
  <div id="sidebar-wrapper-right">
    <div class="detail-section">
      <h4>Información del canal</h4>
      <p ng-bind="channel.selected.description"></p>
    </div>

    <div class="detail-section" ng-if="channel.selected.fullscreen.video">
      <youtube code="channel.selected.fullscreen.video"></youtube>
    </div>

    <div class="detail-section" ng-if="can('board-config') && show_details">
      <h4>Configuración</h4>
      <form class="form-inline">
        <div class="form-group">
          <label for="yt-code">Código de Youtube</label>
          <input type="text" class="form-control" id="yt-code" placeholder="abcde123" ng-model="channel.selected.new_yt_code">
        </div>
        <button type="submit" class="btn btn-default" ng-click="updateChannelMeta()">Actualizar video</button>
      </form>
    </div>

    <div class="detail-section">
      <h4>Spartanos conectados</h4>

      <input type="text" ng-model="searchText.content" class="form-control mb-20">

      <ul class="user-status">
        <li class="online" ng-repeat="m in members | filter:searchText.content | orderBy:['username']">
          <a href="/u/{{ m.username }}/{{ m.id }}" class="">
            <span class="avatar" title="{{ m.username }}" ng-if="!m.image">{{ m.username[0] }}</span>
            <img class="avatar" ng-src="{{ m.image }}" alt="{{ m.username }}" ng-if="m.image">
          </a>
          <a href="/u/{{ m.username }}/{{ m.id }}" class="username">{{ m.username }}</a>

          <span ng-if="m.id != user.info.id && can('edit-category-comments')" ng-click="m.hide_info = !m.hide_info"><i class="fa fa-ban"></i></span>

          <div class="status" ng-class="{'writing': m.writing}"><i class="fa fa-ellipsis-h" ng-if="m.writing"></i></div>

          <div uib-collapse="!m.hide_info" ng-if="m.id != user.info.id && can('edit-category-comments')" style="padding: 10px 0; border-bottom: 1px solid #ddd;">
            <div class="btn-toolbar">
              <a href="" ng-click="suspendUser(m.id, 60*5); m.already_blocked = true" class="btn btn-default btn-sm" ng-class="{'disabled': m.already_blocked}">Bloquear</a>
            </div>
          </div>
        </li>
      </ul>
    </div>
  </div>
  <!-- /#sidebar-wrapper -->

</div>
<!-- /#wrapper -->